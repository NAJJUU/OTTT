20230404
*AnnotationWeb RequestParamTest.java
RequestParam을 사용하지 않으면 required가 false이지만
RequestParam을 사용하면 required를 따로 지정해주지 않으면 true이다.

20230425
*게시판 만들때 사용
트랜잭션(ACID)
커밋, 롤백
aop
-aopmain

PK인 ID값이 1번째 insert될 때는 earth이고 
2번째 insert일 때는 earth2이기 때문에
오류 없이 DB에도 잘 저장이 된다.

PK인 ID값이 1번째 insert될 때는 earth이고 
2번째 insert일 때도 earth이기 때문에
오류 날 경우이지만 AutoCommit이 false이기 때문에
rollback으로 오류를 피할 수 있다.
->DB에는 당연히 실행하기 전과 동일하게 유지된다.

PK인 ID값이 1번째 insert될 때는 earth이고 
2번째 insert일 때도 earth이기 때문에
오류가 나는데 AutoCommit이 true로 진행되는 
즉시 commit이 되기때문에 1번째 insert값은
DB에 저장이 되었고 그 다음에 insert되는 값은 오류가 났다.

PK인 ID값이 1번째 insert될 때는 earth이고 
2번째 insert일 때도 earth이기 때문에
오류가 나는데 AutoCommit이 true로 진행되는 
즉시 commit이 되기때문에 1번째 insert값은
DB에 저장이 되었고 그 다음에 insert되는 값은 오류가 났다.

20230426
Repository=DAO:CRUD 담당
Service(business logic): Transaction 담당

20230502
UserDTO를 기반으로 UserDao를 생성해 Mapper에 select와 insert문을 생성하여
회원가입할 때 데이터베이스에 데이터가 입력되도록 만들었고, 로그인 시
데이터베이스에 있는 데이터를 기반으로 로그인이 되도록 만들었다.

20230503
아이디 중복검사 코드
->닉네임 중복검사와 유효성검사 코드도 짬

20230508
공지사항 페이지 코드
->글작성할 때 admin이 Y일때만 글작성 버튼이 나오도록 하려고 했는데
userDTO로 넘겨도 안되서 수업시간에 배운 mode로 변경해서 넘겨주었는데도 안되었다.
근데 mode.toString()으로 변경후 하니까 되었다.
userDTO로 할때도 userDTO.admin.toString()으로 하니까 된다...

이 예외는 "Cannot convert [Y] of type [class java.lang.String] to [class java.lang.Long]"라는 메시지가 있는 javax.el.ELException과 관련이 있습니다. 이 예외는 JSP 페이지에서 특정 표현식을 계산하려고 할 때 발생합니다. 이 경우, JSP 페이지의 85번째 줄에서 mode 변수를 사용하고 있으며, 이 변수는 문자열 "Y"로 설정되어 있습니다. 그러나 해당 표현식에서는 mode 변수가 Long 타입으로 변환되어야 하기 때문에 예외가 발생합니다.
해결 방법으로는 mode 변수의 값을 Long 타입으로 변경하거나, 해당 표현식에서 Long 타입이 아닌 문자열로 사용하도록 변경하는 것이 있습니다. 예를 들어, mode 변수를 문자열 타입으로 변경하려면 ${mode.toString() == 'Y' }와 같이 작성할 수 있습니다. 또는 mode 변수를 Long 타입으로 변경하려면 ${mode == 1 }과 같이 작성할 수 있습니다.
20230508수업@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
BoardController에서 /read GetMapping부분에 매개변수로 SearchItem을 넘겨주었기 때문에 
board.jsp에서 목록 버튼을 눌렀을 때 SearchItem의 queryString을 사용하여 page값과 pageSize를 
넘겨줄 수 있음.
만약 SearchItem을 매개변수로 넘겨주지 않는다면 목록으로 넘어갈 때 그냥 boardList로 넘어감(1페이지로)
->controller에서 매개변수로 받는건 model에 저장을 하지 않아도 사용이 가능한가?????
@@@@@@@@@@@@@@@@@@@@
*20230508 할 것!!
공지사항 완성하기

20230509
검색할 때 키워드는 url에 보내기 때문에 get 방식임
*board.jsp
removeBtn: 원래는 삭제 버튼인데 수정하는 페이지에서는 목록으로 이동하게 만듬
*OTTT
부트스트랩에서 가져온 모달 작동방식 정리하기

20230510
*JSON(JavaScript Object Notation)
Javascript에서 객체를 만들 때 사용하는 표현식으로 데이터를 저장하거나 전송할 때 많이 
사용되는 경량의 DATA 교환형식이다.
->JSON은 프로그래밍 문법도 아닌 단순히 데이터를 표시하는 표현 방법이다.
JSON의 형태는 키(Key)와 값(value)의 쌍으로 이루어져 있는 구조이다.

*OTTT 공지사항, QNA 완료
->QNA 댓글 추가해야함

20230511
QnA 관리자는 모든 글 볼 수 있게 설정해야했는데
쿼리문으로만 진행하려니까 머리가 너무 아파서 그냥 admin을 이용해서 관리자 여부 판단 후
Mapper에서 모든 게시글을 불러오게 만듬

20230516
QnA 댓글 기능 추가 중

20230517
let admin = '${userDTO.admin}'
QnA 댓글에서 관리자일 경우만 댓글에 수정, 삭제보이도록해야헀는데 
script문에서도 ${}를 사용할 수 있더라 ㅎ

20230518
let cmt_no = $('.btn_warning_div').parents('.comment_show').find('.cmt').attr('data-cmt_no')
let article_no = $('.btn_warning_div').parents('.comment_show').find('.cmt').attr('data-article_no')
script에서 parent()와 parents()의 차이 정리하기
부모태그로 갈때는 parent()와 parents()를 사용하고 그 안에서 찾을때는 find()를 사용.
시작을 무조건$(this)로 할 필요없음 ㅎㅋㅎㅋ
->시작을 무조건 $(this)로 해야함($(this)로 안하니까 다른 댓글이 삭제됨...ㅋㅋㅋㅋ)
let article_no = $('.cmt').attr('data-article_no')
이런식으로 바로 찾아가서 사용할 수 있음
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
<div class='comment_show'>
		<div class="pro-dan">
			<div class="cmt"></div>
			<div class="nickname"></div>
		</div>
		<div class="btn_warning_div"><button></div>
	</div>

여기에서 btn_warning_div을 기준으로 cmt로 가려면 코드를 어떻게 써야해??

btn_warning_div를 기준으로 cmt 요소에 접근하려면 parents() 메서드를 사용하여 상위 요소를 선택하면 됩니다. 다음은 해당 코드에 대한 예시입니다:

$('.btn_warning_div').parents('.comment_show').find('.cmt');
위 코드는 btn_warning_div를 기준으로 가장 가까운 .comment_show 요소를 선택하고, 그 하위에서 .cmt 요소를 찾습니다. parents() 메서드를 사용하여 상위 요소를 선택한 후 find() 메서드를 사용하여 하위 요소를 찾는 방법을 적용하였습니다.

이를 통해 btn_warning_div 요소에서 cmt 요소에 접근할 수 있습니다.
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
script에서 attr()는 값을 아예 넣어주는 메서드
QnA board.jsp에서 댓글 수정, 삭제
<내가 처음에 쓴 코드>
if($(this).closest('.comment_show').find("textarea[name=content-area]").attr('readonly', true)){
$(this).closest('.comment_show').find("textarea[name=content-area]").attr('readonly', false)
$(this).closest(".modBtn").html("등록")
$(this).closest('.comment_show').find(".delBtn").html("취소")
return
}
<정현 오빠가 알려준 코드>
if($(this).closest('.comment_show').find("textarea[name=content-area]").attr('readonly') == 'readonly'){
$(this).closest('.comment_show').find("textarea[name=content-area]").attr('readonly', false)
$(this).closest(".modBtn").html("등록")
$(this).closest('.comment_show').find(".delBtn").html("취소")
return
}
내가 쓴 코드는 readonly에 값을 아예 넣어주는 코드라서 readonly일 경우 if문을 들어오면서 
readonly가 false가 되면서 버튼이 등록, 취소로 바뀌는데 또 if문에서 readonly를 확인할 때 
readonly의 false값을 아예 true로 또 바꾸어주어서 계속 if문을 돌게되는 상황이였다.

20230523
controller에서 contentlist를 for문을 통해 content_no을 map의 key값으로 저장 후 map의 list에 
key값인 content_no를 이용해서 content_ott를 list로 저장하고 content_no의 value값으로 넣어줌.
그런데 content_ott에는 img가 없으므로 content_ott와 ott join하여 쿼리문만들어줘야함.
for문을 통해 만들어진 map을 jsp로 보냄
jsp에서 이중for문에 map을 넣고 바깥 for문의 content_no을 이용하여 key값을 불러와서 value를 
for문을 돌려서 출력함

Map map = new HashMap();
List<ContentDTO> list = contentService

for(ContentDTO contentDTO : list){
   ContentNo = contentDTO.getContentNo();
   List<OttDTO> list = OttDTO.getImg(ContentNo);
   map.put((String)ContentNo, list );
}

20230524
어제 생각하고 구상했던거 성공!!!!!
그리고 메인 포스터호버 이미지 별로라고 해서 바꿈

20230525
찜목록 찜 추가하고 삭제하는거 하는중
DB에는 잘 왓다갓다함
근데 UI적으로 ajax도 작동이 안되서 ajax를 기반으로 작동되도록 해야함
그리고 하나의 해당포스터에 찜을 해야하는데 그게 안됌
그냥 모든 작품에 대한 찜이 다나옴
그래서 그거 수정해야함
@@@@@@@@@@@
ajax success 시 바로 반응오게하는거 tmp로 다 작성할 필요없이
document.location.reload(true)이 구문 추가해주면 바로 됨 ㅎㅋㅎㅋ

20230526
찜목록
for문을 돌기 전에 isInWishlist라는 변수를 주고 그에 대한 값을 false로 준다.
for문을 돌면서 wishlist의 content_no과 contentDTO의 content_no과 같으면
isInWishlist 변수에 true값으로 변경해준다.
그러고 아래에서 if문을 통해 isInWishlist값이 true면 찜이 된 버튼을 
isInWishlist값이 false면 찜이 안된 버튼이 뜨게 해주었다.
그러니까 완전 잘됨 ㅎㅋㅎㅋ

document.location.reload(true)로인해 reload될 때 모달이 reload되면서 삭제됨
그래서 모달의 확인 버튼을 눌렀을때 reload되도록 해줌
그러니 모달이 확인버튼 누르기 전까지 안사라짐
->뭔가 작동이되서 UI가 눈에 보이기까지 오래걸려서 그냥 처음했던거에서
모달에 확인버튼 없애고 완료되면 꺼지게함

장르페이지: 최신순으로 불러오고 페이징까지 완료


20230530
검색시 index.jsp로 이동하게 함
검색할 때 form이용해서 각 요소들에 name이름을 넣어주니 같은 value값이라도 상관없어짐
그래서 검색어를 아무것도 입력하지 않고 체크박스에 아무것도 체크하지 않으면 모달창 띄우는 거까지함

낼은 쿼리문 작성해서 List넘기게 하면 될듯 ㅎㅋㅎㅋ

20230531
검색 후 content 불러오는 시간이 너무 김
별점순, 최신순 ajax로 해서 불러와야함
->지금은 안불러와짐
그리고 처음에 들어갈때 최신순이여야하는데 그것도 안됨...

오늘 한거 ott, genre, category form을 통해 보낸거 list로 다 묶어서 map으로 보냄
->메인에서 포스터에 ott 불러온거랑 방식 비슷함.
오늘은 뭔갈 했는데 한거같지 않음..ㅠ

20230601
검색 후 content 불러오는 시간이 너무 긴거 해결함
->표준방식으로 작성하면 시간 완전 짧아지더라...ㅎ
<처음 쿼리문>
SELECT a.content_no, a.content_nm, a.country, a.rating
FROM tb_content a, tb_genre b, tb_content_genre c
, tb_content_ott d, tb_ott e, tb_content_category f, tb_category g 
where a.content_no = c.content_no
   and b.genre_no = c.genre_no
   and a.content_no = f.content_no
   and a.content_no = d.content_no
   and d.ott_no = e.ott_no
   and f.category_no = g.category_no
   or c.genre_no in (5)
   or e.ott_no in (2)
group by a.content_no

<바꾼 쿼리문>
SELECT a.content_no, a.content_nm, a.country, a.rating, c.genre_no, e.ott_no
FROM tb_content a
JOIN tb_content_genre c ON a.content_no = c.content_no
JOIN tb_genre b ON b.genre_no = c.genre_no
JOIN tb_content_ott d ON a.content_no = d.content_no
JOIN tb_ott e ON d.ott_no = e.ott_no
JOIN tb_content_category f ON a.content_no = f.content_no
JOIN tb_category g ON f.category_no = g.category_no
WHERE c.genre_no = 5 OR e.ott_no = 2

첫 번째 쿼리문(표준방식)에서는 조인 조건으로 명시적인 JOIN 구문을 사용하여 테이블 간의 조인을 
수행하고 있습니다. 또한, WHERE 절에서 OR 연산자를 사용하여 c.genre_no와 e.ott_no 각각에 대한 
조건식을 분리하여 처리하고 있습니다.
반면에 두 번째 쿼리문(비표준방식)에서는 명시적인 JOIN 구문을 사용하지 않고, FROM 절에서 테이블을 
나열하여 조인을 수행하고 있습니다. WHERE 절에서 OR 연산자를 사용하여 조건식을 복합적으로 
처리하고 있습니다.
일반적으로 표준 방식으로 OR 연산자를 사용하는 것이 더 효율적입니다. 표준 방식은 OR 연산자를 
사용하여 조건식을 구성하고, 조건식들을 최대한 단순화하여 쿼리 실행 계획을 최적화합니다.
그러나 비표준 방식으로 OR 연산자를 사용하는 경우, 쿼리 실행 계획이 달라지고 성능 저하가 발생할 
수 있습니다. 비표준 방식은 OR 연산자를 반복하여 사용하거나 복잡한 논리식을 구성하는 등의 방법을 
말합니다. 이러한 경우, 데이터베이스 시스템은 더 많은 계산을 수행하고 다양한 조건식의 조합을 
평가해야 하므로 실행 시간이 증가할 수 있습니다.
따라서 일반적으로 표준 방식으로 OR 연산자를 사용하는 것이 성능 면에서 더 우수합니다. 

검색할 때 글을 입력하면 글을 기준으로 ott, category, genre는 or로, 글 부분은 and로 묶어서
글 검색시 글을 포함한것만 나오게했다
->글검색도 or로 하면 글로 검색하는 의미가 무색하게 모든 content가 다 나옴

글검색할때 로그인시 검색기록이 남게해주었음 
로그인이 되어있을 때 검색하고 검색페이지로 넘어가면 검색기록을 insert해주고 
검색페이지에서 그걸 select해오는 방식으로 진행함

20230602
검색페이지에서 검색기록을 하는데 검색기록이 많아지면 보여지는 건 5개인데 나머지는 데이터만
차지해서 삭제를 해야했다.
그래서 검색기록을 list로 받아와 list의 개수가 5개가 넘어가면 삭제를 하도록했다.
그 과정에서 if문을 사용했는데 db에는 5개인데 검색기록에는 6개가 남았다.
그런데 새로고침하면 5개로 바뀜
그래서 if문 안에 redirect를 넣어서 새로고침하도록해주었다.
그랬더니 완전 잘됨 ㅎㅋㅎㅋ

<검색 자동완성>
@@ document.querySelector("#search").value = matchContentList[nowIndex]||""
document.querySelector("#search")는 DOM(Document Object Model)에서 id가 "search"인 요소를 찾아 
반환하는 JavaScript 코드입니다.
.value는 해당 요소의 값(value)을 가져오거나 설정하는 속성(property)입니다. 여기서는 값을 설정하는 
용도로 사용됩니다.
matchContentList[nowIndex]는 matchContentList라는 배열에서 nowIndex에 해당하는 인덱스의 값을 
가져오는 것을 의미합니다.
||는 논리 OR 연산자로, 왼쪽 피연산자가 truthy 값이면 그 값을 반환하고, falsy 값이면 오른쪽 피연산자를 
반환합니다. 따라서 matchContentList[nowIndex]가 truthy 값이면 그 값을 #search 요소의 값으로 
설정하고, falsy 값이면 빈 문자열("")을 #search 요소의 값으로 설정합니다.
요약하면, 위의 코드는 matchContentList[nowIndex]의 값을 가져와서 #search 요소의 값으로 설정하는 
역할을 합니다. nowIndex가 유효한 인덱스일 때 matchContentList의 해당 인덱스 값이 #search 요소에 
설정되며, 그렇지 않을 경우 빈 문자열이 #search 요소에 설정됩니다.

<백틱(``)과 작은 따옴표('')의 차이점>
1. 문자열 내 변수 및 표현식 포함: 백틱을 사용한 템플릿 리터럴은 ${} 구문을 사용하여 변수나 표현식을 
문자열 안에 삽입할 수 있습니다. 예를 들어, ${value}와 같이 변수 value를 포함시킬 수 있습니다. 이는 
문자열 내에서 동적인 값의 삽입이 가능하도록 합니다. 작은 따옴표는 이 기능을 제공하지 않습니다.
2. 줄 바꿈 및 여러 줄 문자열: 백틱을 사용한 템플릿 리터럴은 여러 줄로 이루어진 문자열을 쉽게 표현할 
수 있습니다. 즉, 줄 바꿈 문자를 직접 삽입할 필요 없이 여러 줄의 텍스트를 그대로 포함할 수 있습니다. 
작은 따옴표는 이를 지원하지 않으므로, 여러 줄로 이루어진 문자열을 표현하려면 줄 바꿈 문자를 
명시적으로 추가해야 합니다.
3. 이스케이프 문자 처리: 백틱은 백슬래시()를 사용하여 특수 문자를 이스케이프(escape)하는 것이 
필요하지 않습니다. 즉, 백틱 내에서 따옴표나 역슬래시를 사용할 때 이스케이프 처리할 필요가 없습니다. 
반면에 작은 따옴표는 문자열 내에서 작은 따옴표를 사용하려면 역슬래시로 이스케이프 처리해야 합니다.
->따라서, 백틱을 사용한 템플릿 리터럴은 변수 삽입, 여러 줄 문자열 표현, 이스케이프 처리의 편의성을 
제공하는 반면에 작은 따옴표는 단순한 문자열 표현에 사용됩니다.

* 검색 자동완성 구현하기
1. content 전체 리스트를 불러온다
2. 에이작스를 이용해 리스트에서 가져오는데
그걸 어케하냐고 썅
리스트를 가져올게 아니라 input에 입력한 값을 content_nm으로 데이터에 보내서
content_nm을 가지고 검색때 이용했던 concat으로 list를 불러와야겠네...
그 리스트를 뷰로 보내고 리스트를 보여주는거
근데 개오래 걸리는거 아님..?

검색 자동완성 완료
인터넷에서 찾아서 해보다가 이해가 안되서 걍 내가 아는 방법으로 하보자!! 해서 함
선생님이랑 댓글했을 때 했던거처럼 함
ajax url에 파마미터값으로 input에 작성한 값을 value를 같이 전송함
그렇게해서 서버에서 concat으로 그 value값이 포함된것을 리스트로 가져와서 뷰로 보냄
그리고 그 리스트를 for문을 사용해서 출력되게했다.
그랬더니 이게 되네..?ㅎ




Dao

Service

interface implements

20230603
@RequestParam 어노테이션은 Spring 프레임워크에서 사용되는 어노테이션 중 하나로, HTTP 요청의 쿼리스트링 
매개변수(parameter) 값을 메서드의 매개변수에 자동으로 매핑해주는 역할을 합니다. 즉, 요청의 쿼리스트링에서 특정한 
매개변수를 추출하고, 해당 매개변수 값을 메서드의 매개변수에 자동으로 전달해줍니다.
@RequestParam 어노테이션을 사용하면 쿼리스트링 매개변수 값을 지정된 메서드의 매개변수로 바로 받을 수 있으므로, 
따로 쿼리스트링을 작성할 필요가 없습니다. Spring은 요청의 쿼리스트링에서 매개변수 이름과 일치하는 값을 찾아 
자동으로 바인딩합니다.
http://example.com/api/user?id=123&name=John&age=25
->@GetMapping("/api/user")
public String getUser(@RequestParam("id") int id,
                      @RequestParam("name") String name,
                      @RequestParam("age") int age) {
    // 메서드 내에서 id, name, age 변수를 사용하여 작업을 수행합니다.
    // ...
    return "User information";
}

(@RequestParam(value="content_nm", required = false) String content_nm,
 @RequestParam(value="ott_no", required = false) List<Integer> ott_no,
 @RequestParam(value="gerne_no", required = false) List<Integer> gerne_no,
 @RequestParam(value="category_no", required = false) List<Integer> category_no,
 Model m, SearchItem sc, HttpSession session)

<select name="button" id="searchSelect" onchange="this.form.submit()">
	<option value="date" class="dropdown-itemtemp" ${pr.sc.option=='date' || pr.sc.option=='' ? "selected" : ""}>최신순</option>
	<option value="rate" class="dropdown-itemtemp" ${pr.sc.option=='rate' ? "selected" : ""}>별점순</option>
</select>	

select문에 onchange="this.form.submit()"추가하니까 redirect해서 잘 불러오는듯
근데 controller에 post도 추가해야하고 뷰쪽에서 별점순을 선택해도 최신순으로 뜨고 
그래서 그런지 최신순은 클릭도 안됨..

어케 접근해야할까..

에이작스..?

20230605
검색 후 index에서 별점순 최신순..
에이작스로 해야할 듯....
이게 새로고침되니까 최신순으로 바뀌는거같다.

맵퍼쪽 쿼리문 rating을 리뷰에서 가져오는 과정에서 쿼리문 수정했더니 갑자기 최신순 별점순 개잘됨...ㅋ
이유는 모르겠움...ㅠ
그리고 검색도 ott, category, genre 각각 묶음의 종류는 or로 묶어주고 나머지는 ott, category, genre는 
and로 묶어줌
작동 잘됨
최신순, 별점순 완료!! rating도 content부분에서 컬럼 삭제하고 review쪽꺼 가지고옴(outer join, coalesce)

<해야할 것>
1. sc에서 offset이 안넘어감
2. 페이징 부분에서 sc paramQeury뿐만 아니라 검색정보도 같이 넘어가게 해줘야함
-> offset이 잘 넘어가면 그것도 해결이 될까..??

20230612
searchList에서 date, rate의 value값을 넘겨야 paging에서도 사용이 가능해서 searchItem에 
새로운 메서드 getSearchString을 만들어주었다. 그리고 쿼리스트링으로 넘겨야할 파라미터를 
searchItem에 변수로 저장해주었다. 그래서 option도 searchItem에 있는 것으로 사용하고 controller에서 
option도 쿼리파라미터로 받아오는데 받아오는 데이터가 클릭할 때마다 쌓여서  option=rate,date 이렇게 
option값이 나왔다.
그래서 그걸 해결하기 위해 알아보니까 내가 select에 쓴 onchange="this.form.submit()"을 고쳐야했는데

onchange="this.form.submit()"은 select 요소의 값이 변경될 때마다 현재 폼을 자동으로 제출하는 
JavaScript 코드입니다. 
따라서 최신순, 별점순 옵션을 반복해서 선택하면 this.form.submit()에 의해 폼이 제출되고 현재 선택된 
option 값이 서버에 전달됩니다. 그리고 서버에서는 기존에 전달된 option 값과 새로 전달된 option 
값이 함께 도착하므로 이전 값과 새로운 값을 합쳐서 처리하게 됩니다.
하나의 옵션 값만 사용해야 한다면 <select name="option" id="searchSelect" onchange="submitForm()">
select의 onchange에서 메서드를 하나 생성해서 가져오는데 
<script>
    function submitForm() {
        document.getElementById("searchSelect").form.submit();
    }
</script>
onchange 이벤트가 발생했을 때 submitForm() 함수를 호출하여 폼을 제출하도록 변경한 것입니다. 
이렇게 하면 선택된 옵션 값만 서버로 전송되어 쌓이는 현상을 방지할 수 있습니다.

20230613
<4. QnA, notice 페이징 이부분 잘 작동안되는거 확인하고 고치기(완료)>
 페이지 번호 배너에 showNext부분 a태그에 pr.sc.getQueryString(pr.endPage+1) 이렇게 써야했는데
pr.sc.getQueryString(pr.endPage-1)로 썼었움..ㅎ

<5. QnA 부분 댓글 글쓰기할 때도 나오는거 고치기>
if($(mode != 'new')){
	if(result && result.length > 0){
		$("#commentList").html(toHtml(result))
	}							
	else{
	         let tmp = '<div style="margin-bottom: 100px;"><div style="margin-left: 55px; margin-bottom: 10px; font-size:20px;">댓글</div>';
	         tmp += "<div style='margin-left: 55px; margin-bottom: 10px; font-size:16px;'>작성된 댓글이 없습니다.</div>";
	         $("#commentList").html(tmp+'</div>');
	}							
}

mode가 new일 경우에는 아예 아무것도 뜨지 않도록 if문 추가해서 전체부분을 감싸줌
원래 썼던 코드는 
if(result && result.length > 0){
	$("#commentList").html(toHtml(result))
}							
else{
         let tmp = '<div style="margin-bottom: 100px;"><div style="margin-left: 55px; margin-bottom: 10px; font-size:20px;">댓글</div>';
         tmp += "<div style='margin-left: 55px; margin-bottom: 10px; font-size:16px;'>작성된 댓글이 없습니다.</div>";
         $("#commentList").html(tmp+'</div>');
}		

<2. 메인 찜 많은 순 쿼리 써서 찜많은 순 메인에 표시하기>
<select id="jjimSelect">
	SELECT a.content_no, a.content_nm, a.thumbnail,
	       COALESCE((SELECT ROUND(AVG(c.rating))/2 FROM tb_review c WHERE c.content_no = a.content_no), 0) AS rating,
	       COUNT(d.content_no) AS jjimcount
	FROM tb_content a
	FULL OUTER JOIN tb_review c ON a.content_no = c.content_no
	FULL OUTER JOIN tb_wishlist d ON a.content_no = d.content_no
	group  by a.content_no 
	ORDER BY jjimcount DESC
	LIMIT 14  
</select>
※ count() 집계함수를 사용할 때는 group by를 사용해주어야함

<추가정보입력>
일단 ott, genre에 name이랑 value줌..
버튼 아무것도 선택안하고 완료 누르면 모달 떠야하는데 안뜸...

내일 해야할 거
1. 아무것도 선택안하고 완료누르면 모달 띄우기
2. ott, genre list로 넘겨서 DB에 insert하기

20230614
1. 아무것도 선택안하고 완료누르면 모달 띄우기(완료)
2. ott, genre list로 넘겨서 DB에 insert하기(완료)
user_no이 필요해서 회원가입 후 addInfo 다음에 complete로 이동시켰는데 회원가입 후 
complete로 이동해 login하여 세션에 user_no을 저장한 후 addInfo를 진행시킴
addinfo를 통해 유저의 선호 ott와 선호 genre 모두 검색때와 같이 list로 받아와서 DB로 넘김
3. 페이징시 페이지 색 줘서 몇페이지인지 사용자가 알 수 있게하기(완료)
페이징시 foreach문을 사용해서 페이지를 나타내서 for문을 사용해서 i값과 page값이 같으면 
스타일 적용하면 되겠다고는 생각이 들었지만 어떻게 구현해야할지 선뜻 코드 작성이 안되었다.
<c:forEach var="i" begin="${pr.beginPage }" end="${pr.endPage }">
	<li class="page-item ${i == pr.sc.page ? 'active' : ''}">
		<a class="page-link" href='<c:url value="/community/QnA${pr.sc.getQueryString(i)}" />'>${i}</a>
	</li>
</c:forEach>
그런데 li태그에 active속성을 주면 된다네..?
<li class="page-item ${i == pr.sc.page ? 'active' : ''}">
이 부분에서 active가 되면
<li class="page-item active">
    <a class="page-link" href="/community/QnA?page=2">2</a>
</li>
코드가 이렇게 되면서 같은 페이지인 부분의 li가 active되며 page-item이 active상태일때 style을 추가하면 됐다.
※active 클래스는 주로 네비게이션 메뉴, 페이지 번호 등에서 현재 위치나 상태를 시각적으로 표시하는 데 활용됩니다.
    .page-item.active .page-link {
	z-index: 1;
	color: #33ff33;
    background-color: #202020; 
    border-color: #33ff33;
}
css는 이렇게 추가했는데 page-link:hover와 같은 효과가 나타나도록했고 z-index만 추가해 주었다.


1. searchlist 페이징 완전히 완료하기(완료 20230612)
2. 메인 찜 많은 순 쿼리 써서 찜많은 순 메인에 표시하기(완료 20230613)
3. 회원가입 시 추가 정보 DB에 넣는거(완료 20230614)
4. QnA, notice 페이징 이부분 잘 작동안되는거 확인하고 고치기(완료 20230613)
5. QnA 부분 댓글 글쓰기할 때도 나오는거 고치기(완료 20230613)
6. 페이징시 페이지 색 줘서 몇페이지인지 사용자가 알 수 있게하기(완료 20230614)


내일 해야할 거
1. 추천작품 메인화면에 불러오기
2. 회원가입시 정보 다 입력 안하면 회원가입 버튼 적용 안되게 하기

20230615
1. 추천작품 메인화면에 불러오기
user_ott, user_genre
user_ott, user_genre list로 select해서 map에 저장 후 Dao로 보냄
dao에서 받은 정보로 contentList 받아서 보여주기
->메인화면 로딩하는데 시간 개오래 걸리겠네,,

봤어요, 추가정보 기반의 작품정보 쿼리문 2개 만들어야함

<추천작품>
1. 로그인 안했을 때
봤어요 많은 작품으로 추천작품 가져오기(봤어요 많은 순 -> 별점순)
2. 로그인 했을 때
입력한 추가 정보를 기반으로 작품을 가져옴(작품들 별점 순 -> 작품 등록 순)
입력한 추가 정보가 없을 때 추가정보를 입력하면 작품 추천해준다고 알려줌
======================================================
2. 회원가입시 정보 다 입력 안하면 회원가입 버튼 적용 안되게 하기
버튼 적용 안되게까지는 함
pattern="^[가-힣a-zA-Z]{2,15}$" required 사용해서 각각 정규식 넣어줌
이렇게 하니까 저 정규식에 맞지 않으면 못넘어감

내일 해야할거
1. 이제 비밀번호랑 재확인 비밀번호랑 같을 때 넘어가게하기만 하면됌
2. 인증번호랑

20230616
1. 이제 비밀번호랑 재확인 비밀번호랑 같을 때 넘어가게하기만 하면됌
각 input별(id, pwd, 이름, 닉네임, 이메일) input에 속성 pattern을 이용하여 각각에 맞는 정규식을 
지정해주었고 required를 이용해서 무조건 input에 값이 있어야 넘어갈 수 있도록 해주었다.
pattern은 정규식을 통해 들어갈 문자열 종류와 최소길이와 최대길이도 설정해줄 수 있었다.
-id 정규식: pattern="^[a-zA-Z0-9]{6,}$"
-pwd 정규식: pattern="^(?=.*\d)(?=.*[a-z])(?=.*[^\da-zA-Z])(.{8,20})$"
-이름 정규식: pattern="^[가-힣a-zA-Z]{2,15}$"
-닉네임 정규식: pattern="^[가-힣a-zA-Z]{2,8}$"
-이메일 정규식: pattern="^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$
※ 인증번호 보내는 거 성공하면 인증번호확인란에도 pattern required 추가해서 정규식 넣어주어야함
비밀번호 재확인 input이나 성별 부분은 pattern으로 할 수 없어서 확인 버튼 누르면 submit될 때 
onsubmit으로 새로운 메서드를 만들어 비밀번호가 일치하지 않으면 submit이 안되도록 해주었다.
성별은 그냥 선택안하면 페이지 이동이 안되게 한듯...<-이거는 내가 안해서 잘 모룸..

회원가입 페이지 자체가 내가 만든게 아니라 기능들을 구현하는데 어려웠다...
심지어 내가 알지 못하는 코드들 가득... 그래서 더 어렵고 힘들었는데
해보니 왕 뿌듯 ㅎㅋㅎㅋ


일욜날에 혹시나 정현오빠 만난다면 인증번호 하기


20230619
회원가입 인증번호 성공...
어떻게 했는지 사실 잘 기억안남...
구글 아이디로 인증메일을 보냈다.
이떄 구글 아이디를 사용하기 위해서는 2차인증도 해야하고 앱비밀번호도 설정해야했다..
이거때문에 개오래걸림..ㅜ
<!-- email 인증 관련 -->
<bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
    <property name="host" value="smtp.gmail.com" />
    <property name="port" value="587" />
    <property name="username" value="otttmailcheck@gmail.com" />
    <property name="password" value="qkdwoohzwdbqzcbc" />	이거 앱비밀번호로 입력해야함
    <!-- 보안 연결(TLS)과 관련된 설정 -->
    <property name="javaMailProperties">
        <props>
            <prop key="mail.transport.protocol">smtp</prop>
            <prop key="mail.smtp.auth">true</prop>
            <!-- gmail의 경우 보안문제 업데이트로 인해 SSLSocketFactory를 추가해야 smtp 사용 가능. -->
            <prop key="mail.smtp.socketFactory.class">javax.net.ssl.SSLSocketFactory</prop>
            <prop key="mail.smtp.starttls.enable">true</prop>
            <prop key="mail.debug">true</prop>
            <prop key="mail.smtp.ssl.trust">smtp.gmail.com</prop>
		<prop key="mail.smtp.ssl.protocols">TLSv1.2</prop>
        </props>
    </property>
</bean>

컨트롤러쪽에 인증번호로 이용할 번호를 생성해주는 메서드를 만들어주고 jsp에서 인증번호 전송시 ajax로 controller에서
인증번호를 생성하고 입력받은 email로 메일을 보내준다. 그리고 jsp쪽에서 입력한 값과 인증번호를 비교해 
다음 페이지로 넘어갈지 아닐지 판단한다.

20230620
<오늘 해야할 것>
0. 회원가입할 때 이메일도 유효성 검사하기 
이메일 주소 하나당 가입 한번만 가능하게

중복아이디, 중복닉네임, 중복이메일일 때 회원가입 안되게 

1. 아이디 찾기(완료)
이메일 인증을 통해 아이디 찾기
다음으로 넘어가면 아이디를 바로 알려줌

카운트로 해서 where절에 email넣고 0이 아니면 아이디 찾을 수 있게(인증번호 전송할 때 체크하기)
2. 비밀번호 찾기
아이디와 이메일 인증을 통해 비밀번호 찾기
다음으로 넘어가면 비밀번호 재설정

아이디랑 이메일 주소가 같지 않으면 비밀번호 못찾도록(인증번호 전송할 때 체크하기)

갑자기 머리 개복잡해져서 진심 아오 개빡치네 썅
내가 이걸 왜 다하고있어야하는데 
일단 낼부터 할래ㅠ

20230621
<오늘 해야할 것>
1. 이메일 중복검사 ajax로 실행하고 아이디, 닉네임, 이메일 등 중복되면 안되는 부분 
중복되게 입력하면 회원가입 안되게 했음
javascript도 한부분으로 다 합침
@@@@@@@@@@@@@@@@@@@@@오류부분 잘 모르겠으면 내가 사용하는 변수들 controller부분에서 다 출력해보기

20230622
<오늘 해야할 것>
1. 아이디 찾기 
이메일 유효성 검사 후 있는 이메일일때와 없는 이메일일때와 구분하기(완료)

2. 비밀번호 찾기
아이디와 이메일로 찾고 둘이 동일해야 비밀번호 재설정 가능하도록하기(완료)

controller에 비밀번호 update만 설정해둠
그거가지고 이제 비밀번호 재설정 부분해야함

20230623
<오늘 해야할 것>
1. 비밀번호 재설정 후 로그인 페이지에 모달창 띄우기
FindController(비밀번호 재설정, post /checkPwd)
-RedirectAttributes 써서 비밀번호 수정 성공 여부를 msg로 전달했음
-성공하면 login페이지로 실패하면 다시 비밀번호 재설정 하는 부분으로 redirect했다.
-RedirectAttributes는 내가 url 파라미터를 추가해주지 않아도 자동으로 추가됨
-그래서 login페이지로 넘어갈때 pwdMsg가 url 파라미터로 같이 넘어감
-loginForm.jsp부분에서 pwdMsg에따라 모달창을 띄워주는데 원래라면 url 파라미터로 받아온 
pwdMsg를 LoginController 부분에서 다시 넘겨주어야하는데 loginForm.jsp부분에서 
let pwdMsg = "<%= request.getParameter("pwdMsg") %>";
변수에 request.getParmeter()를 이용하여 가져와 저장해주었다.
※<%= request.getParameter("pwdMsg") %> 부분이 URL 파라미터에서 pwdMsg 값을 받아오는 
부분으로 이렇게 수정하면 리다이렉트된 페이지에서 URL 파라미터의 pwdMsg 값을 가져와서 
모달이 제대로 표시된다.

@@@@@@원래는 FindController 비밀번호 재설정부분에서 비밀번호가 제대로 수정되면 
redirect말고 그냥 loginForm.jsp로 바로 return했더니 url이 login으로 되어야하는데 
비밀번호 재설정페이지 url인 /login/checkPwd로 되어있었다.
그래서 redirect로 바꾸고 urlParam으로 pwdMsg를 넘겨주었다.

20230626
카테고리 페이지하는데 처음 들어갔을 때 페이지랑 카테고리페이지 검색페이지

정현오빠가 한 방식(에이작스 새로운 방법)으로 진행해보기

20230629
로그인/회원가입
- 회원
-선호장르
-회원 OTT
-장르
-OTT

☆★추가정보 입력, 이메일인증★☆

메인/검색
-영상
-영상 장르
-영상 OTT
-영상 카테고리
-찜목록
-리뷰
-검색어

☆★메인 추천작품, 검색 자동완성★☆

QNA/NOTICE
-회원
-게시글
-게시판 종류
-댓글

☆★관리자 여부에 따른 다른 설정들★☆


정보구조도(뎁스별로 어떤페이지인지)









